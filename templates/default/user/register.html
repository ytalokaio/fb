{% extends "default/panel/layout.html" %} {% load staticfiles %} {% block page_info %}
<li>
    <b>Usuário</b>
</li>
<li>
    <a class="active">Cadastro</a>
</li>
{% endblock %} {% block content %} {% if context %} {% for title, value in context.items %} {{title}} : {{value}}
<br> {% endfor %} {% endif %}
<div id="rootwizard">
    <!-- Nav tabs -->
    <ul class="nav nav-tabs nav-tabs-linetriangle nav-tabs-separator nav-stack-sm">
        <li class="active">
            <a data-toggle="tab" href="#tab1"><i class="fa fa-bars tab-icon"></i>
      <span>
       Dados do usuário
     </span>
   </a>
        </li>
        <li class="">
            <a data-toggle="tab" href="#tab2"><i class="fa fa-map-marker tab-icon"></i> 
    <span>
     Endereço
   </span>
 </a>
        </li>
        {% block subclass_itens %}{% endblock %}
    </ul>
    <!-- Tab panes -->
    <form autocomplete="off" method="post" enctype="multipart/form-data" role="form" id="form-personal" novalidate="novalidate">
        {% csrf_token %}
        <div class="tab-content">
            <div class="tab-pane active slide-left" id="tab1">
                <div class="row row-same-height">
                    {{form.errors}}
                    <div class="col-md-8">
                        <div class="padding-10">
                            <div class="row clearfix p-t-10">
                                <div class="col-sm-8">
                                    <div class="form-group form-group-default required">
                                        <label>{{form.nome.label_tag}}</label>
                                        {{form.nome}}
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group form-group-default">
                                        <label>{{form.tipo_usuario.label_tag}}</label>
                                        <select class="form-control" id="tipo_usuario" name="tipo_usuario">
                                            <option value={{form.tipo_usuario}}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group form-group-default required">
                                        <label>{{form.email.label_tag}}</label>
                                        {{form.email}}
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group form-group-default required">
                                        <label>{{form.password.label_tag}}</label>
                                        {{form.password}}
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group form-group-default required">
                                        <label>{{form.repetir_password.label_tag}}</label>
                                        {{form.repetir_password}}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group form-group-default required">
                                        <label>{{form.cpf.label_tag}}</label>
                                        {{form.cpf}}
                                    </div>
                                    <p id="cpfReport"></p>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group form-group-default required">
                                        <label>{{form.rg.label_tag}}</label>
                                        {{form.rg}}
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group form-group-default">
                                        <label>{{form.orgaoemissor.label_tag}}</label>
                                        {{form.orgaoemissor}}
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group form-group-default">
                                        <label>{{form.genero.label_tag}}</label>
                                        <select class="form-control" id="genero" name="genero">
                                            <option value={{form.genero}}</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group form-group-default">
                                        <label>{{form.data_nascimento.label_tag}}</label>
                                        {{form.data_nascimento}}
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <div class="form-group form-group-default">
                                        <label>{{form.foto.label_tag}}</label>
                                        {{form.foto}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="row p-t-10">
                            <div id="id_phone_table" class="row form-group-attached p-t-10">
                                {% for form in formset.forms %}
                                <div id="{{ form.prefix }}-row" class="tr form-group-attached">
                                    <div class="row">
                                        <div class="col-sm-5">
                                            <div class="form-group form-group-default">
                                                <label>{{form.tipo_telefone.label_tag}}</label>
                                                <div style="text-align:center;">{{ form.tipo_telefone }}</div>
                                            </div>
                                        </div>
                                        <div class="col-sm-7">
                                            <div class="form-group form-group-default">
                                                <label>{{form.numero.label_tag}}</label>
                                                <div style="text-align:center;">{{ form.numero }}</div>
                                            </div>
                                        </div>
                                        <div></div>
                                    </div>
                                </div>
                                {% endfor %} {{formset.management_form}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="tab-pane slide-left padding-20" id="tab2">
                <div class="row row-same-height">
                    <div class="col-md-12">
                        <div class="padding-10">
                            <div class="row clearfix">
                                <div class="col-sm-3">
                                    <div class="form-group form-group-default">
                                        <label>{{form.cep.label_tag}}</label>
                                        {{form.cep}}
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="form-group form-group-default required">
                                        <label>{{form.pais.label_tag}}</label>
                                        {{form.pais}}
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="form-group form-group-default required">
                                        <label>{{form.estado.label_tag}}</label>
                                        {{form.estado}}
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="form-group form-group-default required">
                                        <label>{{form.cidade.label_tag}}</label>
                                        {{form.cidade}}
                                    </div>
                                </div>
                            </div>
                            <div class="row clearfix">
                                <div class="col-sm-6">
                                    <div class="form-group form-group-default required">
                                        <label>{{form.rua.label_tag}}</label>
                                        {{form.rua}}
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="form-group form-group-default">
                                        <label>{{form.numero.label_tag}}</label>
                                        {{form.numero}}
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="form-group form-group-default">
                                        <label>{{form.bairro.label_tag}}</label>
                                        {{form.bairro}}
                                    </div>
                                </div>
                            </div>
                            <div class="row clearfix">
                                <div class="col-sm-6">
                                    <div class="form-group form-group-default">
                                        <label>{{form.complemento.label_tag}}</label>
                                        {{form.complemento}}
                                    </div>
                                </div>
                                <div class="col-sm-6">
                                    <div class="form-group form-group-default">
                                        <label>{{form.pontoreferencia.label_tag}}</label>
                                        {{form.pontoreferencia}}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% block subclass_form %}{% endblock %}
            <div class="padding-20 bg-white">
                <ul class="pager wizard">
                    <li class="next">
                        <button class="btn btn-primary btn-cons pull-right" type="button">
                            <span>Próximo</span>
                        </button>
                    </li>
                    <li class="next finish hidden">
                        <button class="btn btn-primary btn-cons btn-animated from-left fa fa-arrow-right pull-right" type="button">
                            <span>Cadastrar</span>
                        </button>
                    </li>
                    <li class="previous first hidden">
                        <button class="btn btn-default btn-cons btn-animated from-left fa fa-cog pull-right" type="button">
                            <span>Primeiro</span>
                        </button>
                    </li>
                    <li class="previous">
                        <button class="btn btn-default btn-cons pull-right" type="button">
                            <span>Anterior</span>
                        </button>
                    </li>
                </ul>
            </div>
    </form>
    </div>
</div>
{% endblock %} {% block javascript %}
<script src="{% static 'js/default/jquery.inputmask.min.js' %}" type="text/javascript"></script>
<script src="{% static 'js/default/form_wizard.js' %}" type="text/javascript"></script>
<script src="{% static 'js/default/jquery.bootstrap.wizard.min.js' %}" type="text/javascript">
</script>
<script src="{% static 'js/default/bootstrap-datepicker.js' %}" type="text/javascript"></script>
<script>
$(document).ready(function() {
    console.log();
    // multiple fields
    $(function() {
        $('#id_phone_table .tr').formset()
    })

    //Input mask
    $("#id_cpf").mask("999.999.999-99");
    //$("#id_rg").mask("9.999.999");
    $("#id_cep").mask("99.999-999");
    $("#id_cep_empresa_cliente").mask("99.999-999");
    $('#id_data_nascimento').mask("99/99/9999");
    $('#id_dt_admissao').mask('99/9999');


});

var hostname = location.host

//Service CEP
function get_cep_data(value) {
    var cep = value.replace(/\D/g, '');
    var url = "http://" + hostname + "/framework/service/cep/"
    if (cep) {
        $.ajax({
            type: 'GET',
            url: url,
            data: {
                'cep': cep
            },
            dataType: 'json',
            success: function(response) {
                console.log(response)
                document.getElementById("id_estado").value = response.estado
                document.getElementById("id_cidade").value = response.cidade
                document.getElementById("id_bairro").value = response.bairro
                document.getElementById("id_rua").value = response.logradouro
                document.getElementById("id_pais").value = "Brasil"
            },
            error: function(response) {
                console.log(response)
            }
        });
    }
};

function get_cep_data_empresa(value) {
    var cep = value.replace(/\D/g, '');
    var url = "http://" + hostname + "/framework/service/cep/"
    if (cep) {
        $.ajax({
            type: 'GET',
            url: url,
            data: {
                'cep': cep
            },
            dataType: 'json',
            success: function(response) {
                console.log(response)
                document.getElementById("id_estado_empresa").value = response.estado
                document.getElementById("id_cidade_empresa").value = response.cidade
                document.getElementById("id_bairro_empresa").value = response.bairro
                document.getElementById("id_rua_empresa").value = response.logradouro
                document.getElementById("id_pais_empresa").value = "Brasil"
            },
            error: function(response) {
                console.log(response)
            }
        });
    }
};

function validar_cpf(strCPF) {
    var Soma;
    var Resto;
    Soma = 0;
    //Substitui todos caracteres inválidos
    strCPF = strCPF.split('.').join('');
    strCPF = strCPF.split('-').join('');
    strCPF = strCPF.split('_').join('');
    if (strCPF && strCPF.length == 11) {
        if (strCPF == "00000000000") {
            document.getElementById('id_cpf').value = "";
            document.getElementById('cpfReport').innerHTML = "CPF Inválido";
            return false;
        }
        for (i = 1; i <= 9; i++) {
            Soma = Soma + parseInt(strCPF.substring(i - 1, i)) * (11 - i);
        }
        Resto = (Soma * 10) % 11;
        if ((Resto == 10) || (Resto == 11)) {
            Resto = 0;
        }
        if (Resto != parseInt(strCPF.substring(9, 10))) {
            document.getElementById('id_cpf').value = "";
            document.getElementById('cpfReport').innerHTML = "CPF Inválido";
            return false;
        }
        Soma = 0;
        for (i = 1; i <= 10; i++) {
            Soma = Soma + parseInt(strCPF.substring(i - 1, i)) * (12 - i);
        }
        Resto = (Soma * 10) % 11;
        if ((Resto == 10) || (Resto == 11)) {
            Resto = 0;
        }
        if (Resto != parseInt(strCPF.substring(10, 11))) {
            document.getElementById('id_cpf').value = "";
            document.getElementById('cpfReport').innerHTML = "CPF Inválido";
            return false;
        }
        document.getElementById('cpfReport').innerHTML = "";
        return true;
    }
};





//Submit form
$(".finish").click(function() {
    $("#form-personal").submit();
});
</script>
{% endblock %}
